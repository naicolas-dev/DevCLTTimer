<Window x:Class="DevCLT.WindowsApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="clr-namespace:DevCLT.WindowsApp.Views"
        xmlns:vm="clr-namespace:DevCLT.WindowsApp.ViewModels"
        xmlns:conv="clr-namespace:DevCLT.WindowsApp.Converters"
        Title="Dev CLT Timer"
        Width="460" Height="640"
        MinWidth="360" MinHeight="500"
        WindowStyle="SingleBorderWindow"
        Background="{StaticResource BackgroundBrush}"
        Closing="Window_Closing"
        Icon="pack://application:,,,/app.ico">

    <Window.Resources>
        <conv:BoolToVisibilityConverter x:Key="BoolVis" />
        <DataTemplate DataType="{x:Type vm:SetupViewModel}">
            <views:SetupView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:TimerViewModel}">
            <views:TimerView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:HistoryViewModel}">
            <views:HistoryView />
        </DataTemplate>
    </Window.Resources>

    <Grid>
        <!-- Recovery Card (top, over content) -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Recovery Card -->
            <Border Grid.Row="0"
                    Visibility="{Binding ShowRecoveryCard, Converter={StaticResource BoolVis}}"
                    Style="{StaticResource CardBordered}"
                    Margin="24,24,24,0"
                    BorderBrush="{StaticResource WarningBrush}">
                <StackPanel>
                    <TextBlock Text="Parece que o app foi fechado enquanto o timer rodava."
                               Style="{StaticResource BodyText}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16" />
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Style="{StaticResource SecondaryButton}"
                                Content="Descartar sessÃ£o"
                                Command="{Binding DiscardRecoveryCommand}"
                                Margin="0,0,8,0" />
                        <Button Style="{StaticResource PrimaryButton}"
                                Content="Retomar contagem"
                                Command="{Binding ResumeRecoveryCommand}" />
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Current View (dynamic content) -->
            <ContentControl Grid.Row="1" Content="{Binding CurrentView}" />
        </Grid>
    </Grid>
</Window>
